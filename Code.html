<!DOCTYPE html>
<html lang="en">
<head>
<title>Katie Fear's Personal Website</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="format.css"> 
</head>
<body>
    <div class="header">
  <h1>Katherine R. Fear</h1>
  <h2>Code samples</h2>
</div>

<div class="navbar">
  <a href="index.html" class="button">Home </a> 
  <a href="About_me.html" class="button">About Me</a> 
  <a href="Map_projects.html" class="button">Map Projects</a> 
  <a href="Code.html" class="button">Code</a> 
  
</div>


<!-- <button Class="red_box" href="https://github.com/kfear1/Arcpy-shape-file-manipulation" >Code</button> -->

<button class="red_box">
  <a href="https://github.com/kfear1/Arcpy-shape-file-manipulation" class="red_box" target="_blank"> Creating and manipulating shapefiles with arcpy </a> 
</button>

<button class="red_box">
  <a href="https://github.com/kfear1/Arcpy-shape-file-manipulation" class="red_box" target="_blank"> Doing something else with other code </a> 
</button>

<div>
<pre>

  It could be good to: 
  Separate into R and Python
  Also need to give this section a class
<code>

#Here is a sample of what my code could look like

income<- read_sf("Data/Income.shp")
Aug<- read_sf("Data/Augusta_ll.shp")

#Projection conversion

st_crs(income)
st_crs(Aug)
Aug_Nad83<- Aug %>% st_transform(crs=26919)
st_crs(Aug_Nad83)

#Create 3 buffer feature classes frpm Augusta_ll with     3 distance settings: 100,000; 200,000; 300,000. (Unit = Meter) 

d100<- st_buffer(Aug_Nad83, dist= 100000)
plot(d100)
d200<- st_buffer(Aug_Nad83, dist=200000)
d300<- st_buffer(Aug_Nad83, dist=300000)
plot(d200)
plot(d300)

d1<- st_difference(d300, d200)
plot(d1)
d1<- subset(d1,select=-Name.1)
plot(d1)
d2<- st_difference(d200, d100)
d2<-subset(d2, select=-Name.1)

#combine into one shapefile
dAll<- rbind(d1,d2,d100)
plot(dAll)
dAll$ID<-1:3
plot(dAll)

#Create sf object (dAllIncome) by intersecting dAll with income.shp (dAllIncome) 

dAllIncome<- st_intersection(dAll, income)
plot(dAllIncome)

#Create a field “area” in dAllIncome to store area value for each polygon.

dAllIncome$Area <- st_area(dAllIncome)/1000000
head(dAllIncome)

#Create a sf object (AllBand) which dissolves polygon boundaries inside each buffer. Also create a field “AB_Area” to store area value for each buffer area (0-100k, 100k-200k, 200k-300k) 

AllBand<- dAllIncome%>% group_by(ID)%>% summarise()%>% ungroup()%>% st_as_sf()

plot(AllBand)

AllBand$AB_Area<- st_area(AllBand)/1000000
AllBand_df<- AllBand%>% st_drop_geometry()

#Join AllBand to dAllIncome to calculate weighted average income for each buffer ring. 
DAllIncome_Band<- left_join(dAllIncome,AllBand_df, by=c("ID"="ID"))
head(DAllIncome_Band)

DAllIncome_Band$ratio<-DAllIncome_Band$Area/DAllIncome_Band$AB_Area

DAllIncome_Band$wtInc<-DAllIncome_Band$Income*DAllIncome_Band$ratio 
  
AllBandInc<- DAllIncome_Band%>%group_by(ID)%>%summarise(wtInc=sum(wtInc,na.rm=TRUE))%>% ungroup()%>% st_as_sf()


AllBandInc$wtInc <- as.numeric(AllBandInc$wtInc)


ggplot(AllBandInc) +
  geom_sf(aes(fill = wtInc)) + theme_bw()+labs(fill="Weighted average income")+scale_fill_continuous(low="khaki", high="firebrick", labels=comma)
</div>
</code>
</pre>
    
</body>
</html>